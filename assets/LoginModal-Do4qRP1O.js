import{d as R,L as $,M as K,e as F,r as h,O as G,o as r,c,G as Q,P as H,i as k,a as f,m as I,h as w,F as D,D as U,t as N,s as L,n as B,_ as S,Q as J,k as W,z as X,f as V,w as E,g as C,T as Y}from"./index-CXo_6V7_.js";import{s as Z,A as j}from"./vue-focus-lock-o7lSmNbc.js";import{P as O}from"./PrimaryBtn-CoAHtMqP.js";import ee from"./CircleBtn-BDmKuVsq.js";const oe=["type","placeholder","autocomplete"],se={key:0,class:"input-box__icon-container"},ae={key:1,class:"input-box__error-list"},te={class:"input-box__error"},ne={key:3,class:"input-box__btn-close"},re=R({__name:"AppInput",props:$({modelValue:{},placeholder:{default:""},appearance:{default:"form"},inputIconName:{},type:{default:"text"},focus:{type:Boolean},errors:{},autocomplete:{}},{modelValue:{},modelModifiers:{}}),emits:$(["input"],["update:modelValue"]),setup(e,{emit:t}){const o=e,u=t,l=K(e,"modelValue"),p=F(()=>({"input-box--search":o.appearance==="search","input-box--form":o.appearance==="form","input-box--error":o.errors,"input-box--password":o.type==="password"})),g=h(!1),n=F(()=>o.type==="password"&&g.value===!0?"text":o.type);function _(){g.value=!g.value}return(s,i)=>{const a=G("focus");return r(),c("div",{class:L(["input-box",p.value])},[Q(k("input",{class:"input-box__input",type:n.value,placeholder:s.placeholder,onInput:i[0]||(i[0]=d=>u("input")),"onUpdate:modelValue":i[1]||(i[1]=d=>l.value=d),autocomplete:s.autocomplete},null,40,oe),[[a,s.focus||!1],[H,l.value,void 0,{trim:!0}]]),s.inputIconName?(r(),c("div",se,[f(I,{"icon-name":s.inputIconName},null,8,["icon-name"])])):w("",!0),s.errors&&s.errors.length?(r(),c("ul",ae,[(r(!0),c(D,null,U(s.errors,(d,v)=>(r(),c("li",{class:"input-box__error-item",key:v},[k("span",te,N(d),1)]))),128))])):w("",!0),s.type==="password"?(r(),c("button",{key:2,class:L(["input-box__btn-eye",{"input-box__btn-eye--checked":g.value}]),"aria-label":"show password",type:"button",onClick:B(_,["prevent"])},[f(I,{"icon-name":"IconEye"})],2)):w("",!0),s.appearance==="search"?(r(),c("button",ne,[f(I,{"icon-name":"IconClose"})])):w("",!0)],2)}}}),le=S(re,[["__scopeId","data-v-72f1c5b7"]]),ie={class:"form__list"},ue=R({__name:"AppForm",props:{inputs:{},btnName:{},rules:{},formName:{},showSpinner:{type:Boolean},serverErrors:{}},emits:["submitForm"],setup(e,{emit:t}){const o=e,u=t,l=h({}),p=h({});o.inputs.forEach(s=>{l.value[s.name]=s.value||""});function g(s){var a;const i={};return(a=o.rules)==null||a.forEach(d=>{const v=d.validate(s);if(v){const[y,x]=Object.entries(v)[0];y in i?i[y].push(x):i[y]=[x]}}),i}function n(s){delete p.value[s]}function _(){if((!o.serverErrors||o.serverErrors&&!Object.keys(o.serverErrors).length)&&(p.value=g(l.value)),!Object.keys(p.value).length){const s={formData:l.value,formName:o.formName};u("submitForm",s)}}return J(()=>o.serverErrors,s=>{s&&(p.value=s)}),(s,i)=>(r(),c("form",{class:"form",onSubmit:B(_,["prevent"])},[k("ul",ie,[(r(!0),c(D,null,U(s.inputs,(a,d)=>(r(),c("li",{class:"form__item",key:d},[f(le,{"input-icon-name":a.iconName,placeholder:a.placeholder,type:a.type,focus:a==null?void 0:a.focus,autocomplete:a.autocomplete,errors:p.value[a.name],onInput:v=>n(a.name),modelValue:l.value[a.name],"onUpdate:modelValue":v=>l.value[a.name]=v},null,8,["input-icon-name","placeholder","type","focus","autocomplete","errors","onInput","modelValue","onUpdate:modelValue"])]))),128))]),f(O,{class:"form__btn-submit",type:"sumbit","bg-color":"light","show-spinner":s.showSpinner,"btn-name":s.btnName},null,8,["show-spinner","btn-name"])],32))}}),z=S(ue,[["__scopeId","data-v-0057b50a"]]);function ce(e){return typeof e=="object"&&e!==null&&typeof e.email=="string"&&typeof e.password=="string"&&Object.keys(e).length===2}function me(e){return typeof e=="object"&&e!==null&&typeof e.email=="string"&&typeof e.password=="string"&&typeof e.name=="string"&&typeof e.surname=="string"&&typeof e.confirmPassword=="string"&&Object.keys(e).length===5}function b(e,t){if(e in t)return t[e];throw new TypeError(`Field ${e} not found`)}const pe={required:e=>t=>b(e,t).length?null:{[e]:"This field is required"},minLength:(e,t)=>o=>{const u=b(e,o);return u&&u.length>=t?null:{[e]:`Cannot be shorter than ${t} characters`}},email:e=>t=>{const o=b(e,t);return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)?null:{[e]:"Invalid email"}},sameAs:(e,t)=>o=>{const u=b(e,o),l=b(t,o);return u===l?null:{[e]:"Passwords do not match"}}},de={class:"modal-box__title"},fe={key:0,class:"modal-box__message"},ve=R({__name:"LoginModal",setup(e){const t=W(),o=X(),{email:u,minLength:l,required:p,sameAs:g}=pe,n=h("authorization"),_=F(()=>n.value==="authorization"?"Authorization":"Registration"),s=F(()=>n.value==="authorization"?"Registration":"Authorization"),i=h(null),a=h(null),d=[{name:"email",iconName:"IconEmail",placeholder:"E-mail",focus:!0,autocomplete:"email"},{name:"password",iconName:"IconKey",placeholder:"Password",type:"password",autocomplete:"current-password"}],v=[{name:"email",iconName:"IconEmail",placeholder:"E-mail",focus:!0,autocomplete:"email"},{name:"name",iconName:"IconUser",placeholder:"Name",autocomplete:"username"},{name:"surname",iconName:"IconUser",placeholder:"Surname",autocomplete:"username"},{name:"password",iconName:"IconKey",placeholder:"Password",type:"password",autocomplete:"new-password"},{name:"confirmPassword",iconName:"IconKey",placeholder:"Confirm password",type:"password",autocomplete:"new-password"}],y=[{validate:u("email")},{validate:p("password")}],x=[{validate:u("email")},{validate:l("name",2)},{validate:l("surname",2)},{validate:l("password",6)},{validate:p("confirmPassword")},{validate:g("confirmPassword","password")}];async function P(){t.toggleLoginModal(!1)}function A(){n.value==="authorization"?n.value="registration":(n.value==="registration"||n.value==="success")&&(n.value="authorization")}async function T(m){await o.fetchLogin(m),o.isLogin?t.toggleLoginModal(!1):i.value={email:["Incorrect E-mail or password"],password:["Incorrect E-mail or password"]}}async function q(m){await o.fetchRegistration(m),o.isRegistrationSuccess?n.value="success":a.value={email:["This email address is already registered"]}}function M(m){m.formName==="signIn"&&ce(m.formData)?T(m.formData):m.formName==="signUp"&&me(m.formData)&&q(m.formData)}return(m,ge)=>(r(),V(j,{color:"light",onClose:P},{default:E(()=>[f(C(Z),null,{default:E(()=>[k("div",{class:L(["modal-box",{"modal-box--success":!0}])},[f(ee,{class:"modal-box__btn-close","aria-label":"close",appearance:"modal",onClick:P},{default:E(()=>[f(I,{"icon-name":"IconClose"})]),_:1}),f(I,{class:"modal-box__logo","icon-name":"IconLogo"}),k("h2",de,N(_.value),1),f(Y,{name:"flip",mode:"out-in"},{default:E(()=>[n.value==="success"?(r(),c("p",fe," Registration successful! Please use your email to log in. ")):n.value==="authorization"?(r(),V(z,{key:1,class:"modal-box__form","btn-name":"Sign in",inputs:d,rules:y,"server-errors":i.value,"show-spinner":C(o).isLoginLoading,"form-name":"signIn",onSubmitForm:M},null,8,["server-errors","show-spinner"])):n.value==="registration"?(r(),V(z,{key:2,class:"modal-box__form","btn-name":"Sign up",inputs:v,rules:x,"server-errors":a.value,"show-spinner":C(o).isRegistrationLoading,"form-name":"signUp",onSubmitForm:M},null,8,["server-errors","show-spinner"])):w("",!0)]),_:1}),n.value==="success"?(r(),V(O,{key:0,"btn-name":s.value,"bg-color":"light",onClick:A},null,8,["btn-name"])):(r(),c("button",{key:1,class:"modal-box__text-btn",onClick:A},N(s.value),1))])]),_:1})]),_:1}))}}),we=S(ve,[["__scopeId","data-v-22e54058"]]);export{we as default};
